<div class="row-fluid">
	<div class="box span12" ng-controller="EventDetailCtrl"
		ng-init="init()">
		<div class="box-header">
			<h2>
				<i class="icon-edit"></i>赛事管理
			</h2>
		</div>
		<!-- <div class="gridStyle" ng-grid="gridOptions"></div> -->

		<!---->
		<div class="box-content" ng-show="isGeneratedGrades==false">
			<table
				class="table table-striped table-bordered bootstrap-datatable datatable">
				<thead>
					<tr>
						<th>选手名</th>
						<th>属性</th>
						<th>车次</th>
						<th>状态</th>
						<th>成绩</th>
						<th>排名</th>
						<th>当前组别</th>
						<th>操作</th>
					</tr>
				</thead>
				<!-- ng-repeat="(key, value) in eventInit.attendees | groupBy:'team'" -->
				<tbody >
					<tr ng-repeat="attendee in eventInit.attendees | orderBy:'rank'">
						<td class="center">
							<center>
								<div>
									<img ng-src="{{attendee.avatarUrl}}" width="100"></img>
								</div>
								<div>{{attendee.kidName}}</div>
							</center>
						</td>
						<td class="center">
							<div ng-show="eventInit.team">
								战队：<span class="label label-success">{{attendee.teamName}}</span>
							</div>
							<div ng-show="attendee.schoolType!=2">{{attendee.schoolName}}</div>
						</td>
						<td class="center">{{attendee.seq}}</td>
						<td class="center"><span
							ng-class="{true:'label label-success', false:'label label-warning'}[attendee.score > 0]">{{{true:'已完成比赛',
								false:'未完成比赛'}[attendee.score > 0]}}</span></td>
						<td class="center"><span ng-hide="attendee.editing"
							ng-bind="attendee.min"></span> <input ng-model="attendee.min"
							ng-show="attendee.editing" class="form-control gridInput" />分<span
							ng-hide="attendee.editing" ng-bind="attendee.sec"></span> <input
							ng-model="attendee.sec" ng-show="attendee.editing"
							class="form-control gridInput" />秒
							<button class="btn btn-info" ng-hide="attendee.editing"
								ng-click="clickToEditScore(attendee)">修改</button>
							<button class="btn btn-info" ng-show="attendee.editing"
								ng-click="editScore();attendee.editing=false;">确定</button></td>
						<td class="center">{{attendee.rank}}</td>
						<td class="center">
							<span ng-click="attendee.editingRound=true"
								ng-hide="attendee.editingRound"
								ng-bind="{true: '未授予组别', false : attendee.roundName}[attendee.roundName==null]"
								ng-class="showTagClass(attendee.roundType)">
							</span>
							 <select
								ng-show="attendee.editingRound" class="selectpicker gridInput1"
								data-style="btn-info" ng-model="attendee.roundId"
								ng-options="option.id as option.name for option in attendee.thisLevelRounds">
							</select>
						<td class="center"><span class="btn btn-warn"
							ng-click="giveCredit(attendee)"
							ng-disabled="canGiveCredit(attendee)">授予积分</span>
							<span ng-class="{true:'btn btn-warn', false:'btn btn-error'}[attendee.nextLevelRounds.length==0]"
							ng-click="attendee.toNextRound=true" ng-hide="attendee.toNextRound" ng-bind="{true: '比赛完成', false : '晋级下一轮'}[attendee.nextLevelRounds.length==0]"></span>
							<select
								ng-show="attendee.toNextRound" class="selectpicker gridInput1"
								data-style="btn-info" ng-model="attendee.roundId"
								ng-options="option.id as option.name for option in attendee.nextLevelRounds">
							</select></td>
					</tr>
				</tbody>
			</table>
		</div>
		<div class="box-content" ng-show="isGeneratedGrades">
			<div>
				按组别选择：<select class="selectpicker gridInput4" data-style="btn-info"
					ng-model="choosedOptionId"
					ng-change="chooseAttendeesByTag(choosedOptionId)"
					ng-options="option.id as option.name for option in eventTags"></select>
					<div><span class="btn btn-info" ng-click="cancelTagGroupChoose()">取消组别选择</span></div>
			</div>
			<table
				class="table table-striped table-bordered bootstrap-datatable datatable">
				<thead>
					<tr>
						<th>选手名</th>
						<th>状态</th>
						<th>成绩</th>
						<th>排名</th>
						<th>组别</th>
					</tr>
				</thead>
				<tbody>
					<tr ng-repeat="attendee in eventInit.attendees | orderBy:'rank'">
						<td class="center">
							<center>
								<div>
									<img ng-src="{{attendee.avatarUrl}}" width="100"></img>
								</div>
								<div>{{attendee.kidName}}</div>
							</center>
						</td>
						<td class="center"><span
							ng-class="{true:'label label-success', false:'label label-warning'}[attendee.score > 0]">{{{true:'已完成比赛',
								false:'未完成比赛'}[attendee.score > 0]}}</span></td>
						<td class="center"><span ng-hide="attendee.editing"
							ng-bind="attendee.min"></span> <input ng-model="attendee.min"
							ng-show="attendee.editing" class="form-control gridInput" />分<span
							ng-hide="attendee.editing" ng-bind="attendee.sec"></span> <input
							ng-model="attendee.sec" ng-show="attendee.editing"
							class="form-control gridInput" />秒
						<td class="center">{{attendee.rank}}</td>
						<td class="center"><span ng-click="attendee.editingRound=true"
							ng-hide="attendee.editingRound"
							ng-bind="{true: '未授予组别', false : attendee.roundName}[attendee.roundName==null]"
							ng-class="showTagClass(attendee.roundType)"></span> <select
							ng-show="attendee.editingRound" class="selectpicker gridInput2"
							data-style="btn-info" ng-model="attendee.roundId"
							ng-options="option.id as option.name for option in eventRounds">
						</select></td>
					</tr>
				</tbody>
			</table>
		</div>
		<div class="box-content control-group">
			<div class="controls">
				<button type="button" class="btn btn-info"
					ng-click="applyAttendeeChanges()">保存</button>
				<button type="button" class="btn btn-warn"
					ng-click="generateGrades()">{{generateGradesLabel}}</button>
			</div>
		</div>

	</div>
</div>
<!--/row-->